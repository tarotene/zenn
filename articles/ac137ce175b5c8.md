---
title: "Bash ã®ã‚³ãƒãƒ³ãƒ‰ç½®æ›ã«ãŠã‘ã‚‹ stdout / stderr ã®å‡ºã—åˆ†ã‘"
emoji: "ğŸ§"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Bash", "C"]
published: true
---

## å¥‘æ©Ÿ

ã¨ã‚ã‚‹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ï¼ŒC ã®ãƒ˜ãƒƒãƒ€ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«é…åˆ—ã®åˆæœŸåŒ–ãƒªãƒ†ãƒ©ãƒ«ã‚’æ³¨å…¥ã™ã‚‹ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒç”¨ã„ã‚‰ã‚Œã¦ã„ãŸ [^do-not-do-such-a-legacy-thing]ï¼

[^do-not-do-such-a-legacy-thing]: æ–°è¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ã“ã†ã„ã†æ…£ç¿’ã¯è¾ã‚ã¾ã—ã‚‡ã†ã­ï¼

ã“ã®ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ï¼Œåˆ¥ã® C ãƒ™ãƒ¼ã‚¹ã®å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ã«ã¨ã‚ã‚‹ã‚·ã‚§ãƒ«å¤‰æ•°ï¼ˆæ”¹è¡Œã‚’å«ã¾ãªã„ ID ãƒ©ã‚¤ã‚¯ãªã‚‚ã®ï¼‰ã®ä¸­èº«ã‚’é£Ÿã‚ã›ï¼Œå¤‰æ•°ã®ä¸­èº«ã‚’é€æ¬¡çš„ã« `charã€€*` å‹ã«ç½®ãæ›ãˆãŸå¾Œï¼Œå‰è¿°ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ã‚¯ãƒ­ãƒ¼ãƒ³ã« `sed` ã§å©ãè¾¼ã‚“ã§ C ã®ãƒ˜ãƒƒãƒ€ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦è§£é‡ˆå¯èƒ½ã«ã—ãŸå¾Œï¼Œæ›´ã«åˆ¥ã®ã‚·ã‚§ãƒ«å¤‰æ•°ã«ä»£å…¥ã™ã‚‹ã¨ã„ã†ã¨ã‚“ã§ã‚‚ãªã„ã“ã¨ã‚’ã‚„ã£ã¦ã„ãŸï¼

è¦ã™ã‚‹ã«ï¼Œã“ã‚Œã®ãƒ‡ãƒãƒƒã‚°ã‚’ CI ç’°å¢ƒã§è¡Œã†å¿…è¦ãŒç”Ÿã˜ãŸï¼

## å•é¡Œ

å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ã® I/O ãŒ `stdin` / `stdout` é ¼ã¿ã ã£ãŸãŸã‚ï¼Œã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆä¸Šã§ã‚·ã‚§ãƒ«å¤‰æ•°ã«ä»£å…¥ã™ã‚‹éç¨‹ã‚’æ±šã•ãšã« print ãƒ‡ãƒãƒƒã‚°ã™ã‚‹æ–¹æ³•ãŒæ¬²ã—ã‹ã£ãŸï¼

çµè«–ã‹ã‚‰è¨€ãˆã°ï¼Œè‡³ã£ã¦ã‚·ãƒ³ãƒ—ãƒ«ãªã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã§è§£æ±ºå¯èƒ½ã§ï¼Œæ¨™æº–ã‚¨ãƒ©ãƒ¼å‡ºåŠ› `stderr` ã‚’ä½¿ãˆã°ä½•ã®å•é¡Œã‚‚ç”Ÿã˜ãªã„ï¼

å®Ÿéš›ï¼Œ[Bash ã®ãƒãƒ‹ãƒ¥ã‚¢ãƒ«](https://www.gnu.org/software/bash/manual/html_node/Command-Substitution.html)ã‚’å‚ç…§ã™ã‚‹ã¨ï¼Œä¸‹è¨˜ã®ã‚ˆã†ãªè¨˜è¼‰ãŒã‚ã‚‹:

> Bash performs the expansion by executing *command* in a subshell environment and replacing the command substitution with the standard output of the command, with any trailing newlines deleted. Embedded newlines are not deleted, but they may be removed during word splitting. The command substitution `$(cat file)` can be replaced by the equivalent but faster `$(< file)`.

ã™ãªã‚ã¡ï¼Œã‚³ãƒãƒ³ãƒ‰ç½®æ›ã«ãŠã„ã¦ã¯æ¨™æº–å‡ºåŠ›ã—ã‹å‚ç…§ã•ã‚Œãªã„ã‚‰ã—ã„ï¼

ã—ãŸãŒã£ã¦ï¼Œå¤‰æ•°ã®ä¸­èº«ã‚’ tty ä¸Šã§ãƒ€ãƒ³ãƒ—ã—ãŸã‘ã‚Œã°åˆæ‰‹ã§æ¨™æº–ã‚¨ãƒ©ãƒ¼å‡ºåŠ›ã‚’æ¤œè¨ã™ã‚‹ã®ãŒè‰¯ã•ãã†ã§ã‚ã‚‹ï¼

## ä¾‹

ä¸‹è¨˜ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’è€ƒãˆã‚‹:

```c:std_test.c
#include <stdio.h>

int main(void) {
 fprintf(stderr, "stderr\n");
 fprintf(stdout, "stdout\n");
 return 0;
}
```

ã“ã„ã¤ã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã¦å®Ÿè¡Œã™ã‚‹ã¨ï¼Œtty ä¸Šã®çµæœã¯ä¸‹è¨˜ã®ã‚ˆã†ã«ãªã‚‹:

```plaintext
â¯ ./a.out
stderr
stdout
```

ä¸€æ–¹ã§ï¼Œã“ã‚Œã®å®Ÿè¡Œçµæœã‚’ã‚³ãƒãƒ³ãƒ‰ç½®æ›ã§ã‚·ã‚§ãƒ«å¤‰æ•°ã«ä»£å…¥ã™ã‚‹ã¨ï¼Œçµæœã¯ä¸‹è¨˜ã®ã‚ˆã†ã«ãªã‚‹:

```plaintext
â¯ OUTPUT=$(./a.out)
stderr
â¯ echo $OUTPUT
stdout
```

## çµã³

Bash ã®ã‚³ãƒãƒ³ãƒ‰ç½®æ›ãŒæ¨™æº–å‡ºåŠ›ã®ã¿ã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã™ã‚‹æŒ™å‹•ã¯ä½•ã‚‰ã‹ã®å¿œç”¨ãŒå¯èƒ½ï¼
